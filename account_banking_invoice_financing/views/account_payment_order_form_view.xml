<?xml version="1.0" encoding="utf-8"?>
<!--
  Â© 2016 Akretion (Alexis de Lattre <alexis.delattre@akretion.com>)
  License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl).
-->
<odoo>


    <record id="invoice_financing_account_payment_order_form" model="ir.ui.view">
        <field name="model">account.payment.order</field>
        <field name="inherit_id" ref="account_payment_order.account_payment_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="/form/sheet/group[@name='head']" position="after">
                <group name="invoice_invoice_financing_fields" attrs="{'invisible': [('payment_method_code', '!=', 'invoice_financing')]}">
                    <field name="payment_method_code" invisible="1"/>

                    <field name="massimale" readonly="1"/>
                    <field name="bank_invoice_financing_amount" attrs="{'readonly': [('state', '!=', 'draft')]}"/>

                    <field name="forecast_payment_date" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                    <field name="bank_invoice_financing_date"/>
                    <field name="bank_return_payment_date"/>

                    <field name="bank_invoice_financing_number"/>
                </group>
            </xpath>

            <xpath expr="//button[@name='action_cancel']" position="before">
                <field name="payment_method_code" invisible="1" />
                <field name="is_wallet_company_bank" invisible="1" />
                <button name="action_anticipo_aperto"
                        type="object"
                        attrs="{'invisible': ['|', '|', ('payment_method_code', '!=', 'invoice_financing'),
                        ('state', '!=', 'uploaded'), ('is_wallet_company_bank', '=', False)]}"
                        string="Apri anticipo"
                        class="oe_highlight"/>
            </xpath>

            <xpath expr="//button[@name='action_cancel']" position="before">
                <field name="payment_method_code" invisible="1" />
                <field name="anticipo_aperto" invisible="1"/>
                <button name="action_anticipo_chiuso"
                        type="object"
                        attrs="{'invisible': ['|', ('payment_method_code', '!=', 'invoice_financing'),
                        '|', ('anticipo_aperto', '=', False), ('state', '!=', 'done')]}"
                        string="Chiudi anticipo"
                        class="oe_highlight"/>
            </xpath>

        </field>
    </record>


</odoo>


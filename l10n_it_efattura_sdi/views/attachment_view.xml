<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <record id="view_fatturapa_out_state" model="ir.ui.view">
            <field name="name">fatturapa.attachment.out.state</field>
            <field name="model">fatturapa.attachment.out</field>
            <field name="type">tree</field>
            <field name="inherit_id" ref="l10n_it_fatturapa_out.view_fatturapa_out_attachment_tree"/>
            <field name="arch" type="xml">
                <tree position="attributes">
                    <attribute name="colors">red:sdi_state in ('NS', 'EC_RIFIUTO'));blue:state=='ready';orange: state=='sent';green: state in ('RC', 'MC')</attribute>
                </tree>
                <field name="invoice_partner_id" position="after">
                    <field name="sdi_id" readonly="True" />
                    <field name="sdi_send_date" readonly="True" />
                    <field name="sdi_state" readonly="True" />
                </field>
            </field>
        </record>

        <record id="view_fatturapa_out_state_form" model="ir.ui.view">
            <field name="name">fatturapa.attachment.out.state.form</field>
            <field name="model">fatturapa.attachment.out</field>
            <field name="inherit_id" ref="l10n_it_fatturapa_out.view_fatturapa_out_attachment_form"/>
            <field name="arch" type="xml">
                <field name="name" position="after">
                    <field name="sdi_state" />
                    <newline/>
                    <group  attrs="{'invisible': [('state','!=','ready')]}">
<!--                        <button name="action_send_invoice" string="Send invoice to SDI" type="object" icon="gtk-go-up" attrs="{'invisible': [('xml_error', '=', True)]}"/>-->
<!--                        <button name="action_send_invoice" string="Send invoice to SDI Warning" type="object" icon="gtk-go-up" attrs="{'invisible': [('xml_error', '!=', True)]}" confirm="Attenzione stai inviando nonostante l'anomalia"/>-->
                        <button name="action_send_invoice" string="Send invoice to SDI" type="object" icon="/l10n_it_efattura_sdi/static/src/img/upload.png" />
                    </group>
                    <group  attrs="{'invisible': [('state','!=','sender_error')]}">
                        <button name="action_check_state" string="Check invoice state on SDI" type="object" icon="/l10n_it_efattura_sdi/static/src/img/check_state.png" />
                    </group>
                </field>
            </field>
        </record>

<!--        <record id="view_fatturapa_out_attachment_state_search" model="ir.ui.view">-->
<!--            <field name="name">fatturapa.attachment.out.search</field>-->
<!--            <field name="model">fatturapa.attachment.out</field>-->
<!--            <field name="type">search</field>-->
<!--            <field name="inherit_id" ref="l10n_it_fatturapa_out.view_fatturapa_out_attachment_search"/>-->
<!--            <field name="arch" type="xml">-->
<!--                <field name="name" position="before">-->
<!--                    <filter name="to_transmit" icon="gtk-network" string="Da trasmettere" domain="[('state','=','ready')]" help="Invoices To Transmitted to SDI"/>-->
<!--                    <filter name="error" icon="gtk-dialog-error" string="Errore" domain="[('state','=','NS')]"/>-->
<!--                    <filter name="transmitted" icon="gtk-ok" string="Ricevuta" domain="[('state','=','RC')]"/>-->
<!--                    <filter name="not_delivered" icon="terp-mail_delete" string="Mancata Consegna" domain="[('state','=','MC')]"/>-->
<!--                </field>-->
<!--            </field>-->
<!--        </record>-->

        <record id="action_send_e_invoice_sdi" model="ir.actions.server">
            <field name="name">Send E-invoices to SDI</field>
            <field name="model_id" ref="model_fatturapa_attachment_out"/>
            <field name="state">code</field>
            <field name="code">self.action_send_invoice(cr, uid, [], context=context)</field>
        </record>

    </data>
</odoo>
